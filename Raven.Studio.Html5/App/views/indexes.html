<div id="indexesContainer">
    <div class="btn-toolbar" role="toolbar">
        <div class="btn-group">
            <a class="btn btn-primary use-bootstrap-tooltip" data-trigger="hover" data-toggle="tooltip" data-placement="bottom" data-bind="attr: { href: newIndexUrl }" title="Add a new index (Alt+N)" accesskey="N"><i class="fa fa-plus"></i></a>
            <a class="btn btn-default use-bootstrap-tooltip" data-trigger="hover" data-toggle="tooltip" data-placement="bottom" data-bind="attr: { href: queryUrl }" title="New query (Alt+Q)" accesskey="Q"><i class="fa fa-search"></i> Query</a>
            <div class="btn-group">
                <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                    Recent Queries <span class="caret"></span>
                </button>
                <ul class="dropdown-menu" role="menu" data-bind="foreach: recentQueries">
                    <li>
                        <a href="#" data-bind="attr: { href: $root.getRecentQueryUrl($data) }">
                            <span data-bind="text: IndexName"></span>
                            <span data-bind="visible: QueryText">
                                <span class="text-muted">|</span>
                                <span data-bind="text: QueryText"></span>
                            </span>
                            <span data-bind="visible: Sorts.length">
                                <span class="text-muted">| sort by</span>
                                <span data-bind="text: $root.getRecentQuerySortText($data)"></span>
                            </span>
                            <span data-bind="visible: TransformerName">
                                <span class="text-muted">| transform by</span>
                                <span data-bind="text: TransformerName"></span>
                            </span>
                            <span data-bind="visible: ShowFields">
                                <span class="text-muted">|</span>
                                <span>show fields</span>
                            </span>
                            <span data-bind="visible: ShowFields">
                                <span class="text-muted">|</span>
                                <span>index entries</span>
                            </span>
                            <span data-bind="visible: ShowFields">
                                <span class="text-muted">|</span>
                                <span>AND operator</span>
                            </span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
        <div class="btn-group">
            <button type="button" class="btn btn-default use-bootstrap-tooltip" data-trigger="hover" data-toggle="tooltip" data-placement="bottom" data-bind="click: collapseAll" title="Collapse all index groups (Alt+Minus)" accesskey="-"><i class="fa fa-minus-square-o"></i></button>
            <button type="button" class="btn btn-default use-bootstrap-tooltip" data-trigger="hover" data-toggle="tooltip" data-placement="bottom" data-bind="click: expandAll" title="Expand all index groups (Alt+Plus)" accesskey="+"><i class="fa fa-plus-square-o"></i></button>
        </div>
        <div class="btn-group">
            <button type="button" class="btn btn-danger dropdown-toggle" data-toggle="dropdown">
                <i class="fa fa-trash-o"></i> <span class="caret"></span>
            </button>
            <ul class="dropdown-menu" role="menu">
                <li data-bind="click: deleteIdleIndexes"><a href="#">Delete <span class="text-warning">Idle</span> Indexes</a></li>
                <li data-bind="click: deleteDisabledIndexes"><a href="#">Delete <span class="text-muted">Disabled</span> Indexes</a></li>
                <li data-bind="click: deleteAbandonedIndexes"><a href="#">Delete <span class="text-danger">Abandoned</span> Indexes</a></li>
                <li class="divider"></li>
                <li data-bind="click: deleteAllIndexes"><a href="#">Delete All Indexes</a></li>
            </ul>
        </div>        
    </div>

    <div data-bind="dynamicHeight: { resizeTrigger: window.ravenStudioWindowHeight(), target: 'footer' }">
        <div class="indexes-container panel-group" id="indexesAccordion" data-bind="foreach: sortedGroups">
            <div class="index-group panel panel-default">
                <div class="panel-heading">
                    <div class="pull-right indexGroup-actions-container">                        
                        <button class="btn btn-danger use-bootstrap-tooltip" title="Delete all indexes in group" data-trigger="hover" data-toggle="tooltip" data-placement="bottom" data-bind="click: $root.deleteIndexGroup.bind($root)">
                            <i class="fa fa-trash-o"></i>
                        </button>
                    </div>

                    <h4 class="panel-title">
                        <a data-toggle="collapse" data-bind="attr: { href: '#indexCollapse' + $index() }">
                            <span data-bind="text: entityName"></span>
                            <span class="text-muted" data-bind="text: '(' + indexes().length + ')'"></span>
                        </a>
                    </h4>

                </div>
                <div class="index-group-content panel-collapse in" data-bind="attr: { id: 'indexCollapse' + $index() }">
                    <div class="panel panel-default" style="overflow: visible;">
                        <div class="panel-body" data-bind="foreach: indexes">
                            <div class="index panel panel-default">
                                <div class="panel-body">
                                    <h4 class="pull-left">
                                        <a class="use-bootstrap-tooltip" data-bind="attr: { href: queryUrl }" title="Query this index">
                                            <span data-bind="text: name, css: { 'text-warning': isIdle, 'text-muted': isDisabled, 'text-danger': isAbandoned }"></span>
                                        </a>
                                        <small class="text-warning" data-bind="visible: isIdle">Idle</small>
                                        <small class="text-danger" data-bind="visible: isAbandoned">Abandoned</small>
                                        <small class="text-muted" data-bind="visible: isDisabled">Disabled</small>
                                        <small class="text-muted use-bootstrap-tooltip" data-trigger="hover" data-toggle="tooltip" data-placement="bottom" data-bind="text: ' - ' + docsCount + ' docs' " title=" the number of documents affected by this index"></small>
                                    </h4>
                                    <div class="pull-right index-actions-container">
                                        <button class="btn btn-danger use-bootstrap-tooltip" title="Delete the index" data-trigger="hover" data-toggle="tooltip" data-placement="bottom" data-bind="click: $root.deleteIndex.bind($root)">
                                            <i class="fa fa-trash-o"></i>
                                        </button>
                                        <button class="btn btn-warning indexes-controls use-bootstrap-tooltip" title="Reset the index" data-trigger="hover" data-toggle="tooltip" data-placement="bottom" data-bind="click: $root.resetIndex.bind($root)">
                                            <i class="fa fa-refresh"></i>
                                        </button>
                                        <div class="btn-group indexes-controls">
                                            <label class="btn btn-default use-bootstrap-tooltip" data-trigger="hover" data-toggle="tooltip" data-placement="left" data-bind="click: $root.unlockIndex.bind($root, $data), css: { active: lockMode() === 'Unlock' }" title="Unlocked: The index is unlocked for changes; apps can modify it, e.g. via IndexCreation.CreateIndexes().">
                                                <i class="fa fa-unlock"></i>
                                                Unlocked
                                            </label>
                                            <label class="btn btn-default use-bootstrap-tooltip" data-trigger="hover" data-toggle="tooltip" data-placement="left" data-bind="click: $root.lockIndex.bind($root, $data), css: { active: lockMode() === 'LockedIgnore' }" title="Locked: The index is locked for changes; apps cannot modify it. Programmatic attempts to modify the index will be ignored.">
                                                <i class="fa fa-lock"></i>
                                                Locked
                                            </label>
                                            <label class="btn btn-default use-bootstrap-tooltip" data-trigger="hover" data-toggle="tooltip" data-placement="left" data-bind="click: $root.lockErrorIndex.bind($root, $data), css: { active: lockMode() === 'LockedError' }" title="Locked + Error: The index is locked for changes; apps cannot modify it. An error will be thrown if an app attempts to modify it.">
                                                <i class="fa fa-lock text-danger"></i>
                                                Locked (Error)
                                            </label>
                                        </div>
                                        <!--
                                            COMMENTED OUT: In 3.0, this doesn't seem to do anything. Is it because the index creation and saving has changed?

                                            <button class="btn btn-default btn-warning" title="Make index persistent" data-bind="click: $root.makeIndexPersistent.bind($root, $data), visible: isOnRam() !== 'false'">
                                                <i class="fa fa-download"></i>
                                            </button>-->
                                        <a class="btn btn-primary indexes-controls use-bootstrap-tooltip" title="Edit the index" data-trigger="hover" data-toggle="tooltip" data-placement="bottom" data-bind="attr: { href: editUrl }">
                                            <i class="fa fa-pencil"></i>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>


    </div>
</div>